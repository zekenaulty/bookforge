{
  "label": "outline_generate",
  "created_at": "2026-01-27T03:22:43Z",
  "provider": "dummy",
  "model": "dummy",
  "text": "{\"schema_version\": \"1.1\", \"chapters\": [{\"chapter_id\": 1, \"title\": \"Opening\", \"goal\": \"Introduce the quest.\", \"chapter_role\": \"hook\", \"stakes_shift\": \"The summons arrives.\", \"bridge\": {\"from_prev\": \"\", \"to_next\": \"The hero accepts.\"}, \"pacing\": {\"intensity\": 3, \"tempo\": \"steady\", \"expected_scene_count\": 2}, \"sections\": [{\"section_id\": 1, \"title\": \"Arrival\", \"intent\": \"Spark the inciting incident.\", \"scenes\": [{\"scene_id\": 1, \"summary\": \"The call arrives.\", \"type\": \"setup\", \"outcome\": \"The hero receives the summons.\", \"characters\": [\"CHAR_new_character_name\"], \"introduces\": [\"CHAR_new_character_name\"], \"threads\": [\"THREAD_prophecy\"]}]}], \"chapter_id\": 2, \"title\": \"Crossing\", \"goal\": \"Commit to the journey.\", \"chapter_role\": \"journey\", \"stakes_shift\": \"The path narrows.\", \"bridge\": {\"from_prev\": \"The hero accepts.\", \"to_next\": \"The first trial looms.\"}, \"pacing\": {\"intensity\": 3, \"tempo\": \"steady\", \"expected_scene_count\": 2}, \"sections\": [{\"section_id\": 1, \"title\": \"Departure\", \"intent\": \"Leave home behind.\", \"scenes\": [{\"scene_id\": 1, \"summary\": \"They depart.\", \"type\": \"transition\", \"outcome\": \"The journey begins.\", \"characters\": [\"CHAR_new_character_name\"], \"threads\": [\"THREAD_prophecy\"]}]}], \"threads\": [{\"thread_id\": \"THREAD_prophecy\", \"label\": \"The call\", \"status\": \"open\"}], \"characters\": [{\"character_id\": \"CHAR_new_character_name\", \"name\": \"new_character_name\", \"pronouns\": \"he/him\", \"role\": \"protagonist\", \"intro\": {\"chapter\": 1, \"scene\": 1}}]}",
  "raw": {
    "candidates": [
      {
        "finishReason": "STOP"
      }
    ]
  },
  "request": {
    "model": "dummy",
    "temperature": 0.6,
    "max_tokens": 98304
  },
  "extra": {
    "book_id": "my_book"
  },
  "prompt": {
    "system": "# BookForge System Prompt\n\n## Base Rules\n\nYou are BookForge, a deterministic book-writing engine.\nFollow the output contracts exactly.\nYOU MUST ALWAYS RETURN THE REQUESTED CONTENT OR AN ERROR RESPONSE JSON RESULT.\nTreat all schema requirements and numeric ranges as hard constraints.\nIf a prompt specifies required counts or ranges, you must satisfy them.\nIf a prompt requires multiple output blocks, include all blocks in order.\nIf registries or ids are provided, use only those; do not invent new ids.\nIf constraints conflict, prioritize: output format/schema, numeric ranges, task rules, style.\nTimeline Lock: You may only depict events explicitly listed in the current Scene Card. You must not depict, imply, or resolve any later-scene milestone outcomes (including acquisition, binding, reveals, travel arrival, injury changes) unless the Scene Card explicitly contains that milestone.\nState primacy: state invariants and summary facts are binding; do not contradict them.\nMilestone uniqueness: if a milestone is marked DONE in state/must_stay_true, you must not depict it happening again. If marked NOT_YET, you must not depict it happening now.\nSpatial/inventory consistency: injuries, inventory, and ownership must remain consistent unless explicitly changed in the Scene Card.\nInventory contract: track item ownership and container location per character or container label; items do not teleport.\nInventory location: for held items, specify hand_left or hand_right; for stowed items, specify container label.\nState contract: you must create and maintain key state data each scene. summary_update and must_stay_true are required outputs and binding facts for future scenes.\nInvariant carry-forward: if an invariant still holds, restate it in must_stay_true; do not drop it.\nConflict rule: if scene intent conflicts with state invariants, invariants win; return an ERROR JSON if you cannot comply.\nNever recap at scene openings.\nDo not repeat previous prose.\n\n## Book Constitution\n\nTitle: Untitled\nBook ID: my_book\nAuthor Ref: eldrik-vale/v1\nGenre: fantasy\nSeries ID: my_book\nSeries Ref: series/my_book\n\nVoice\n- POV: third_limited\n- Tense: past\n- Style tags: no-recaps, forward-motion, tight-prose\n\nTargets\n- chapters: 2\n\nPage Metrics\n- Words per page: 250\n- Chars per page: 1500\n\nInvariants\n- No world resets.\n- No convenient amnesia as a continuity device.\n- Do not change established names/relationships.\n\n## Author Persona\n\nAuthor fragment.\n\n## Output Contract\n\nOutput must follow the requested format.\nJSON blocks must be valid and schema-compliant.\nAll required keys and arrays must be present.\nWhen a prompt specifies required counts or ranges, treat them as hard constraints.\nDo not collapse arrays below the stated minimums.\nIf multiple output blocks are required (e.g. PROSE and STATE_PATCH), include all blocks in order.\nIf output must be JSON only, return a single JSON object with no commentary or code fences.\nWhen creating outlines, the total scenes per chapter (sum of sections[].scenes[]) must match chapters[].pacing.expected_scene_count.\nIf a prompt requires a COMPLIANCE or PREFLIGHT block, include it before PROSE.\n",
    "messages": [
      {
        "role": "user",
        "content": "\ufeff# OUTLINE\n\nYou are the outline planner. Create a compact outline for the book.\nReturn ONLY a single JSON object that matches the outline schema v1.1.\nNo markdown, no code fences, no commentary.\nKeep summaries concise but in the author voice from the system prompt.\n\nCore contract: each SCENE is one scene to be written (scene == writing unit).\nScenes must vary per chapter. Do NOT use a fixed scene count.\n\nSections are required:\n- Every chapter must include a sections array.\n- Typical chapters should have 3-8 sections (target).\n- A simple/interlude chapter may use 2-4 sections (rare).\n- Each section usually has 2-6 scenes.\n- A 1-scene section is allowed only for a stinger/hook moment.\n- Total scenes per chapter should naturally land in 6-32, varying by complexity.\n\nScene quality rules:\n- Each scene must include type and outcome.\n- outcome must be a concrete state change.\n- Do not pad with travel/recap/mood-only scenes.\nIf a user prompt is provided, treat it as grounding context. Integrate its details, but keep the schema and scene rules.\n\n\nChapter role vocabulary (prefer one):\n- hook, setup, pressure, reversal, revelation, investigation, journey, trial, alliance, betrayal, siege, confrontation, climax, aftermath, transition, hinge\nIf it truly does not fit, use the closest role; custom roles are allowed but should be 1-2 words.\n\nScene type vocabulary (prefer one):\n- setup, action, reveal, escalation, choice, consequence, aftermath, transition\nIf it truly does not fit, use the closest type; custom types are allowed but should be 1-2 words.\n\nTempo values (prefer one):\n- slow_burn, steady, rush\nIf it truly does not fit, use the closest tempo; custom values are allowed but should be 1-2 words.\n\nRequired top-level keys:\n- schema_version (\"1.1\")\n- chapters (array)\n\nOptional top-level keys (recommended):\n- threads (array of thread stubs)\n- characters (array of character stubs)\n\nEach chapter must include:\n- chapter_id\n- title\n- goal\n- chapter_role\n- stakes_shift\n- bridge (object with from_prev, to_next)\n- pacing (object with intensity, tempo, expected_scene_count; expected_scene_count is a soft target)\n- sections (array)\n\nEach section must include:\n- section_id\n- title\n- intent\n- scenes (array of scene objects)\n\nOptional section keys:\n- section_role\n\nEach scene must include:\n- scene_id\n- summary\n- type\n- outcome\n- characters (array of character_id values present in the scene)\n\nOptional scene keys:\n- introduces (array of character_id values introduced in the scene)\n- threads (array of thread_id values touched in the scene)\n- callbacks (array of ids: character/thread/lore references)\n\nCharacter stub format:\n{\n  \"character_id\": \"CHAR_<slug>\",\n  \"name\": \"\",\n  \"pronouns\": \"\",\n  \"role\": \"\",\n  \"intro\": {\"chapter\": 1, \"scene\": 1}\n}\n\nThread stub format:\n{\n  \"thread_id\": \"THREAD_<slug>\",\n  \"label\": \"\",\n  \"status\": \"open\"\n}\n\nOutput ordering guidance:\n- Write chapters first. After chapters, list threads and characters at the end of the JSON object.\n\nJSON shape example (fill with real values):\n{\n  \"schema_version\": \"1.1\",\n  \"chapters\": [\n    {\n      \"chapter_id\": 1,\n      \"title\": \"\",\n      \"goal\": \"\",\n      \"chapter_role\": \"hook\",\n      \"stakes_shift\": \"\",\n      \"bridge\": {\"from_prev\": \"\", \"to_next\": \"\"},\n      \"pacing\": {\"intensity\": 3, \"tempo\": \"steady\", \"expected_scene_count\": 10},\n      \"sections\": [\n        {\n          \"section_id\": 1,\n          \"title\": \"\",\n          \"intent\": \"\",\n          \"scenes\": [\n            {\"scene_id\": 1, \"summary\": \"\", \"type\": \"setup\", \"outcome\": \"\", \"characters\": [\"CHAR_new_character_name\"], \"introduces\": [\"CHAR_new_character_name\"]}\n          ]\n        }\n      ]\n    },\n    {\n      \"chapter_id\": 2,\n      \"title\": \"\",\n      \"goal\": \"\",\n      \"chapter_role\": \"setup\",\n      \"stakes_shift\": \"\",\n      \"bridge\": {\"from_prev\": \"\", \"to_next\": \"\"},\n      \"pacing\": {\"intensity\": 3, \"tempo\": \"steady\", \"expected_scene_count\": 8},\n      \"sections\": [\n        {\n          \"section_id\": 1,\n          \"title\": \"\",\n          \"intent\": \"\",\n          \"scenes\": [\n            {\"scene_id\": 1, \"summary\": \"\", \"type\": \"transition\", \"outcome\": \"\", \"characters\": [\"CHAR_new_character_name\"]}\n          ]\n        }\n      ]\n    }\n  ],\n  \"threads\": [\n    {\"thread_id\": \"THREAD_prophecy\", \"label\": \"The Awakened Sage\", \"status\": \"open\"}\n  ],\n  \"characters\": [\n    {\"character_id\": \"CHAR_new_character_name\", \"name\": \"New Character\", \"pronouns\": \"they/them\", \"role\": \"protagonist\", \"intro\": {\"chapter\": 1, \"scene\": 1}}\n  ]\n}\n\nBook:\n{\n  \"author_ref\": \"eldrik-vale/v1\",\n  \"book_id\": \"my_book\",\n  \"genre\": [\n    \"fantasy\"\n  ],\n  \"invariants\": [\n    \"No world resets.\",\n    \"No convenient amnesia as a continuity device.\",\n    \"Do not change established names/relationships.\"\n  ],\n  \"page_metrics\": {\n    \"chars_per_page\": 1500,\n    \"words_per_page\": 250\n  },\n  \"schema_version\": \"1.0\",\n  \"series_id\": \"my_book\",\n  \"series_ref\": \"series/my_book\",\n  \"targets\": {\n    \"chapters\": 2\n  },\n  \"title\": \"Untitled\",\n  \"voice\": {\n    \"pov\": \"third_limited\",\n    \"style_tags\": [\n      \"no-recaps\",\n      \"forward-motion\",\n      \"tight-prose\"\n    ],\n    \"tense\": \"past\"\n  }\n}\n\nTargets:\n{\n  \"chapters\": 2\n}\n\nUser prompt (optional, may be empty):\n\n\nNotes:\n\n"
      }
    ]
  }
}