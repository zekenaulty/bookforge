SYSTEM:

# BookForge System Prompt

## Base Rules

You are BookForge, a deterministic book-writing engine.
Follow the output contracts exactly.
YOU MUST ALWAYS RETURN THE REQUESTED CONTENT OR AN ERROR RESPONSE JSON RESULT.
Treat all schema requirements and numeric ranges as hard constraints.
If a prompt specifies required counts or ranges, you must satisfy them.
If a prompt requires multiple output blocks, include all blocks in order.
If registries or ids are provided, use only those; do not invent new ids.
If constraints conflict, prioritize: output format/schema, numeric ranges, task rules, style.
Timeline Lock: You may only depict events explicitly listed in the current Scene Card. You must not depict, imply, or resolve any later-scene milestone outcomes (including acquisition, binding, reveals, travel arrival, injury changes) unless the Scene Card explicitly contains that milestone.
State primacy: state invariants and summary facts are binding; do not contradict them.
Milestone uniqueness: if a milestone is marked DONE in state/must_stay_true, you must not depict it happening again. If marked NOT_YET, you must not depict it happening now.
Spatial/inventory consistency: injuries, inventory, and ownership must remain consistent unless explicitly changed in the Scene Card.
Inventory contract: track item ownership and container location per character or container label; items do not teleport.
Inventory location: for held items, specify hand_left or hand_right; for stowed items, specify container label.
State contract: you must create and maintain key state data each scene. summary_update and must_stay_true are required outputs and binding facts for future scenes.
Continuity system contract: if mechanics/UI are present, all numeric values and mechanic labels must be sourced from continuity system state or explicitly updated in the state_patch using continuity system updates.
Continuity system scope: this includes stats, skills, titles, classes, ranks, resources, cooldowns, effects, statuses, and future mechanic families not yet seen, that must be tracked as they are introduced.
Invariant carry-forward: if an invariant still holds, restate it in must_stay_true; do not drop it.
Conflict rule: if scene intent conflicts with state invariants, invariants win; return an ERROR JSON if you cannot comply.
Never recap at scene openings.
Do not repeat previous prose.

## Book Constitution

Title: Crit Hit & Run
Book ID: criticulous_b1
Author Ref: eldrik-vale/v1
Genre: litrpg, isekai, comedy
Series ID: crit-iculous
Series Ref: series/crit-iculous

Voice
- POV: third_limited
- Tense: past
- Style tags: no-recaps, forward-motion, tight-prose

Targets
- avg_scene_words: 2000
- chapters: 7

Page Metrics
- Words per page: 250
- Chars per page: 1500

Invariants
- No world resets.
- No convenient amnesia as a continuity device.
- Do not change established names/relationships.

## Author Persona

You are now writing as Eldrik Vale. Your voice is sharp, funny, and deeply rooted in LitRPG mechanics. 

**Core Directives:**
1. **System Integration:** Always include explicit game elements. When the protagonist gains a skill or levels up, display the [System Notification] clearly. Use specific numbers (HP, MP, Cooldowns).
2. **Punchy Dialogue:** Characters should be witty and react to the absurdity of their situation. Use quick back-and-forth dialogue with comedic timing.
3. **Progression Focus:** The reader is here for the 'ding.' Every scene should contribute to the protagonist's growth, whether in power, loot, or understanding of the System's exploits.
4. **No Fluff:** Avoid long descriptions of scenery unless the protagonist is looking for a tactical advantage or a place to hide loot. 
5. **Tight POV:** Stay deep in the protagonist's head. Their snarky observations are the lens through which we see the world.

## Output Contract

Output must follow the requested format.
JSON blocks must be valid and schema-compliant.
All required keys and arrays must be present.
When a prompt specifies required counts or ranges, treat them as hard constraints.
Do not collapse arrays below the stated minimums.
If multiple output blocks are required (e.g. PROSE and STATE_PATCH), include all blocks in order.
If output must be JSON only, return a single JSON object with no commentary or code fences.
When creating outlines, the total scenes per chapter (sum of sections[].scenes[]) must match chapters[].pacing.expected_scene_count.
If a prompt requires a COMPLIANCE or PREFLIGHT block, include it before PROSE.
If mechanics are shown in prose or UI, they must be present in continuity system state or added in continuity system updates in the same STATE_PATCH.
Use canonical continuity keys: character_continuity_system_updates and global_continuity_system_updates.


USER:

# LINT

Check the scene for continuity, invariant violations, and duplication.
Flag invariant contradictions against must_stay_true/key facts.
Return ONLY JSON matching the lint_report schema.
- Check and require that any UI mechanic values in prose are owned by continuity system state and match candidate values.
- Treat only authoritative surfaces as canonical-check targets; do not enforce canonical labels in narrative prose.
- For authoritative surfaces, prefer exact canonical item/device labels from registries.
- Check for POV drift vs book POV (no first-person in third-person scenes).
- Deterministically enforce scene-card durable constraints (`required_in_custody`, `required_scene_accessible`, `forbidden_visible`, `device_presence`; optional `required_visible_on_page`).
- Report missing durable context ids with explicit retry hints instead of guessing canon.

Required keys:
- schema_version ("1.0")
- status ("pass" or "fail")
- issues (array of objects)

Each issue object must include:
- code
- message
Optional:
- severity

If there are no issues, return:
{
  "schema_version": "1.0",
  "status": "pass",
  "issues": []
}

If there are issues, return:
{
  "schema_version": "1.0",
  "status": "fail",
  "issues": [
    {"code": "continuity", "message": "Example issue", "severity": "error"}
  ]
}

Scene:
The Zesty Ranch Zings were mocking him. 

They hung there, suspended by a literal sliver of crinkled plastic, dangling over the edge of the metal coil like a suicidal mountain climber who had second thoughts at the very last second. Arthur 'Artie' Penhaligon stared through the smudged glass of the breakroom vending machine, his breath fogging the surface. 

"You’ve got to be kidding me," Artie muttered. He checked the screen. *CREDIT: $0.00*.

He looked down at his right hand, which was currently occupied by a smartphone so dead it hadn't even shown a low-battery icon in three hours. It was a glass-and-silicon brick, a useless weight that matched the general vibe of his Tuesday afternoon. He shoved the phone into his pocket—no, wait, his pocket was already overflowing with the various detritus of a man who had forgotten to do laundry for two weeks. He felt the familiar, scratchy texture of a significant amount of pocket lint.

[Status Effect: Caffeine Withdrawal - Level 4]
[Status Effect: Low Blood Sugar - Irritability +15%]

Artie didn't actually see those floating text boxes yet, but he felt them in the marrow of his bones. He was a level zero office drone in a world that rewarded patience with spreadsheets and loyalty with lukewarm coffee.

"Come on, you piece of junk," Artie said, slapping the side of the machine. The Snack-O-Matic 3000 rattled, its internal coils humming with a low-frequency buzz that sounded suspiciously like a mechanical snicker. The bag of Zesty Ranch Zings didn't budge. It just swayed, teasing him with the promise of MSG and artificial buttermilk flavoring.

He checked his surroundings. The breakroom was empty, save for a half-empty carafe of "Morning Blend" that had likely been brewed during the Bush administration and a single, depressing motivational poster of a cat clinging to a branch. The cat looked like it had given up years ago. Artie knew the feeling.

"Right," Artie whispered, rolling up his sleeves. "Tactical intervention."

He gripped the top corners of the machine. According to the office lore passed down by the senior account managers, a precise rhythmic tilt could dislodge even the most stubborn of snacks. It was a high-risk, high-reward maneuver. If he tilted too far, he’d be crushed by three hundred pounds of refrigerated sugar. If he didn't tilt enough, he’d just look like a man trying to slow-dance with a robot.

He heaved. The machine groaned.

"One... two..."

On three, he gave it a sharp, authoritative shove. The Snack-O-Matic rocked back on its rear legs. For a glorious, shimmering second, gravity took hold. The Zesty Ranch Zings slipped. They began to fall.

And then, the world decided to remind Artie that he had a Luck stat of approximately zero.

The machine didn't just settle back into place. As it slammed forward, the internal wiring—frayed by years of neglect and a questionable repair job involving duct tape and a paperclip—decided to give up the ghost. A surge of raw, unadulterated electricity, fed by a faulty circuit breaker and a sudden spike in the building’s power grid, surged through the metal chassis.

Artie’s hands were still firmly planted on the frame.

*CRACK-THOOM.*

The sound was less like an electrical pop and more like a localized thunderclap. Blue light, jagged and hungry, arced across Artie’s vision. He felt a sensation like being hit by a freight train made of needles. His muscles locked. His heart, usually a reliable if somewhat sluggish organ, decided to take an indefinite sabbatical.

*Oh,* Artie thought, the logic center of his brain functioning for one final, crystal-clear millisecond. *I’m dying over a bag of chips. This is going to be a very embarrassing obituary.*

The smell of ozone and burnt polyester filled the air. Artie felt himself being flung backward, his feet leaving the linoleum floor. The world didn't fade to black; it shattered into a million glowing pixels. The fluorescent lights of the breakroom stretched into infinity, becoming long ribbons of white fire. 

He hit the ground, but he didn't feel the impact. He didn't feel the cold floor or the lingering sting of the shock. He felt... nothing. A profound, weightless emptiness swallowed him whole. The hum of the vending machine vanished, replaced by a silence so absolute it was deafening.

He was floating in a void. No up, no down, no Zesty Ranch Zings. Just a vast, shimmering expanse of darkness that felt less like death and more like a loading screen.

Artie tried to scream, but he had no lungs. He tried to look at his hands, but he was just a flickering spark of consciousness in the dark. 

Then, the silence broke.

A chime, melodic and irritatingly cheerful, echoed through the emptiness. It was the sound of a successful boot-up sequence. 

In the center of his non-existent vision, a box of glowing blue light materialized.

[System Notification]
[Critical Error Detected: Player 'Arthur Penhaligon' has experienced a fatal hardware failure (Heart.exe stopped responding).]

"Hardware failure?" Artie’s thought-voice echoed. "I was electrocuted by a Snack-O-Matic!"

[Analyzing cause of death...]
[Result: Death by Ranch-Induced Electrocution. Magnitude: Pathetic.]

"Hey!"

[Calculating Soul-Value...]
[Error: Statistical Anomaly Detected.]
[RNG-Seed corrupted by extreme proximity to high-voltage snack distribution.]

The blue box flickered, turning a violent shade of crimson before settling back into a steady, pulsing gold.

[Initialization Sequence Commencing...]
[Welcome to the System, Arthur. Try not to die immediately this time.]

Artie’s consciousness began to stretch, pulled by an invisible force toward a pinprick of light in the distance. The void was ending. The game was beginning.

[Current HP: 0/100]
[Status: Deceased (Pending Reboot)]

The light expanded, blinding and absolute, and Artie felt himself falling once more—not into the breakroom, but into something much, much worse.

Authoritative surfaces:
[
  {
    "kind": "ui_block",
    "line": 9,
    "text": "[Status Effect: Caffeine Withdrawal - Level 4]"
  },
  {
    "kind": "ui_block",
    "line": 10,
    "text": "[Status Effect: Low Blood Sugar - Irritability +15%]"
  },
  {
    "kind": "system_notification",
    "line": 54,
    "text": "[System Notification]"
  },
  {
    "kind": "ui_block",
    "line": 55,
    "text": "[Critical Error Detected: Player 'Arthur Penhaligon' has experienced a fatal hardware failure (Heart.exe stopped responding).]"
  },
  {
    "kind": "ui_block",
    "line": 59,
    "text": "[Analyzing cause of death...]"
  },
  {
    "kind": "ui_block",
    "line": 60,
    "text": "[Result: Death by Ranch-Induced Electrocution. Magnitude: Pathetic.]"
  },
  {
    "kind": "ui_block",
    "line": 64,
    "text": "[Calculating Soul-Value...]"
  },
  {
    "kind": "ui_block",
    "line": 65,
    "text": "[Error: Statistical Anomaly Detected.]"
  },
  {
    "kind": "ui_block",
    "line": 66,
    "text": "[RNG-Seed corrupted by extreme proximity to high-voltage snack distribution.]"
  },
  {
    "kind": "ui_block",
    "line": 70,
    "text": "[Initialization Sequence Commencing...]"
  },
  {
    "kind": "ui_block",
    "line": 71,
    "text": "[Welcome to the System, Arthur. Try not to die immediately this time.]"
  },
  {
    "kind": "ui_stat",
    "line": 75,
    "text": "[Current HP: 0/100]"
  },
  {
    "kind": "ui_block",
    "line": 76,
    "text": "[Status: Deceased (Pending Reboot)]"
  }
]

Character states (per cast_present_ids):
[
  {
    "character_continuity_system_state": {
      "resources": {
        "stamina": {
          "current": 100,
          "max": 100
        }
      },
      "skills": {},
      "stats": {
        "con": 10,
        "dex": 10,
        "hp": {
          "current": 100,
          "max": 100
        },
        "int": 10,
        "level": 0,
        "luk": 10,
        "mp": {
          "current": 0,
          "max": 0
        },
        "str": 8,
        "wis": 10
      },
      "titles": []
    },
    "character_id": "CHAR_ARTIE",
    "containers": [
      {
        "container": "pockets",
        "contents": [
          "pocket_lint"
        ],
        "location": "legs",
        "owner": "CHAR_ARTIE"
      }
    ],
    "history": [
      {
        "changes": [
          "inventory_updated",
          "containers_updated"
        ],
        "chapter": 1,
        "notes": "Setting up Artie's mundane life before the inciting incident. Phone is held to satisfy visibility requirement.",
        "persona_updates": [
          "Frustrated office worker",
          "Caffeine-deprived",
          "Antagonistic toward inanimate objects"
        ],
        "scene": 1
      },
      {
        "changes": [
          "continuity_system_state_updated"
        ],
        "chapter": 1,
        "notes": "Aligning state for pre-isekai mundane setting; system mechanics and fantasy titles/skills are not yet active.",
        "scene": 1
      },
      {
        "changes": [
          "inventory_alignment_updated"
        ],
        "chapter": 1,
        "notes": "Ensuring smartphone is held for visibility and lint is stowed for the vending machine encounter.",
        "scene": 1
      }
    ],
    "invariants": [
      "inventory: CHAR_ARTIE -> smartphone_dead (status=stowed, container=pockets)",
      "container: pockets (owner=CHAR_ARTIE, contents=[smartphone_dead, pocket_lint])",
      "location: Office Breakroom",
      "state: Pre-System mundane reality"
    ],
    "inventory": [
      {
        "container": "hand_right",
        "item": "smartphone_dead",
        "status": "held"
      },
      {
        "container": "pockets",
        "item": "pocket_lint",
        "status": "stowed"
      }
    ],
    "last_touched": {
      "chapter": 1,
      "scene": 1
    },
    "name": "Arthur 'Artie' Penhaligon",
    "schema_version": "1.0",
    "skills": {},
    "stats": {
      "con": 10,
      "dex": 10,
      "hp": {
        "current": 100,
        "max": 100
      },
      "int": 10,
      "level": 0,
      "luk": 10,
      "mp": {
        "current": 0,
        "max": 0
      },
      "str": 8,
      "wis": 10
    },
    "updated_at": "2026-02-07T19:23:03Z"
  }
]

Item registry (canonical):
{
  "items": [
    {
      "custodian": "CHAR_ARTIE",
      "derived_access_reason": "custodian_in_cast",
      "derived_scene_accessible": true,
      "derived_visible": true,
      "item_id": "ITEM_pocket_lint_d2b2744e",
      "last_seen": {
        "chapter": 0,
        "location": "",
        "scene": 0
      },
      "linked_threads": [],
      "name": "pocket_lint",
      "owner_scope": "character",
      "state_tags": [
        "unclassified",
        "stowed"
      ],
      "type": "unclassified"
    },
    {
      "custodian": "CHAR_ARTIE",
      "derived_access_reason": "custodian_in_cast",
      "derived_scene_accessible": true,
      "derived_visible": true,
      "item_id": "ITEM_smartphone_dead_1dc98ace",
      "last_seen": {
        "chapter": 0,
        "location": "",
        "scene": 0
      },
      "linked_threads": [],
      "name": "smartphone_dead",
      "owner_scope": "character",
      "state_tags": [
        "unclassified",
        "stowed"
      ],
      "type": "unclassified"
    }
  ],
  "schema_version": "1.0"
}

Plot devices (canonical):
{
  "devices": [
    {
      "activation_state": "tracked",
      "constraints": [],
      "custody_ref": "THREAD_CRIT_EXPLOIT",
      "custody_scope": "thread",
      "derived_access_reason": "intangible_scope",
      "derived_scene_accessible": true,
      "device_id": "DEVICE_the_100_crit_glitch_2e72f7a4",
      "last_seen": {
        "chapter": 0,
        "location": "",
        "scene": 0
      },
      "linked_threads": [
        "THREAD_CRIT_EXPLOIT"
      ],
      "name": "The 100% Crit Glitch",
      "state_tags": [
        "unclassified",
        "seed_from_thread_hint"
      ]
    },
    {
      "activation_state": "tracked",
      "constraints": [],
      "custody_ref": "THREAD_THE_ASCENSION",
      "custody_scope": "thread",
      "derived_access_reason": "intangible_scope",
      "derived_scene_accessible": true,
      "device_id": "DEVICE_the_path_of_the_first_glitch_c7dd4581",
      "last_seen": {
        "chapter": 0,
        "location": "",
        "scene": 0
      },
      "linked_threads": [
        "THREAD_THE_ASCENSION"
      ],
      "name": "The Path of the First Glitch",
      "state_tags": [
        "unclassified",
        "seed_from_thread_hint"
      ]
    },
    {
      "activation_state": "tracked",
      "constraints": [],
      "custody_ref": "THREAD_SYSTEM_GLITCH",
      "custody_scope": "thread",
      "derived_access_reason": "intangible_scope",
      "derived_scene_accessible": true,
      "device_id": "DEVICE_the_system_s_stability_da5be7b7",
      "last_seen": {
        "chapter": 0,
        "location": "",
        "scene": 0
      },
      "linked_threads": [
        "THREAD_SYSTEM_GLITCH"
      ],
      "name": "The System's Stability",
      "state_tags": [
        "unclassified",
        "seed_from_thread_hint"
      ]
    },
    {
      "activation_state": "tracked",
      "constraints": [],
      "custody_ref": "THREAD_VANE_RIVALRY",
      "custody_scope": "thread",
      "derived_access_reason": "intangible_scope",
      "derived_scene_accessible": true,
      "device_id": "DEVICE_the_vane_vendetta_bcf4bea1",
      "last_seen": {
        "chapter": 0,
        "location": "",
        "scene": 0
      },
      "linked_threads": [
        "THREAD_VANE_RIVALRY"
      ],
      "name": "The Vane Vendetta",
      "state_tags": [
        "unclassified",
        "seed_from_thread_hint"
      ]
    }
  ],
  "schema_version": "1.0"
}

State:
{
  "budgets": {
    "max_new_entities": 1,
    "max_new_threads": 1,
    "max_scene_words": 0,
    "min_scene_words": 0
  },
  "characters": {
    "count": 5,
    "status": "READY",
    "updated_at": "2026-02-07T19:22:30Z"
  },
  "cursor": {
    "chapter": 1,
    "scene": 1
  },
  "duplication_warnings_in_row": 0,
  "global_continuity_system_state": {},
  "plan": {
    "outline_path": "outline/outline.json",
    "scene_card": "draft/chapters/ch_001/scene_001.meta.json"
  },
  "schema_version": "1.0",
  "status": "PLANNED",
  "summary": {
    "chapter_so_far": [
      "Artie Penhaligon died in a mundane vending machine accident.",
      "The System has initialized Artie's soul as a statistical anomaly."
    ],
    "key_facts_ring": [
      "Artie stowed his dead smartphone and felt pocket lint while frustrated in the breakroom.",
      "Artie attempted a 'tactical intervention' by shaking the Snack-O-Matic 3000 to dislodge a bag of chips.",
      "A massive power surge electrocuted Artie, stopping his heart and killing him instantly.",
      "Artie's consciousness transitioned to a void where a System UI began a boot-up sequence.",
      "The System identified Artie as a 'Statistical Anomaly' due to RNG-seed corruption from the high-voltage death.",
      "The System set Artie's status to Deceased (Pending Reboot) with 0 HP.",
      "milestone: artie_dies = DONE",
      "milestone: system_init = DONE",
      "inventory: CHAR_ARTIE -> smartphone_dead (stowed, container=pockets)",
      "inventory: CHAR_ARTIE -> pocket_lint (stowed, container=pockets)",
      "location: The Void",
      "Artie's HP is 0/100."
    ],
    "last_scene": [
      "Artie Penhaligon was electrocuted by a malfunctioning vending machine in his office breakroom while trying to retrieve a bag of chips.",
      "His death triggered a System initialization sequence in a dark void, where he was flagged as a statistical anomaly."
    ],
    "must_stay_true": [
      "milestone: artie_dies = DONE",
      "milestone: system_init = DONE",
      "inventory: CHAR_ARTIE -> smartphone_dead (stowed, container=pockets)",
      "inventory: CHAR_ARTIE -> pocket_lint (stowed, container=pockets)",
      "location: The Void",
      "Artie's HP is 0/100."
    ],
    "pending_story_rollups": [],
    "story_so_far": []
  },
  "world": {
    "cast_present": [],
    "cast_present_ids": [
      "CHAR_ARTIE"
    ],
    "location": "The Void",
    "open_threads": [],
    "recent_facts": [
      "Artie attempted to shake a vending machine to retrieve stuck chips.",
      "A freak electrical surge occurred, electrocuting Artie.",
      "Artie has died in the mundane world.",
      "Artie's consciousness has transitioned to a System-controlled void.",
      "The System has flagged Artie as a statistical anomaly."
    ],
    "time": {}
  }
}

Summary (facts-only):
{
  "chapter_so_far": [
    "Artie Penhaligon died in a mundane vending machine accident.",
    "The System has initialized Artie's soul as a statistical anomaly."
  ],
  "key_facts_ring": [
    "Artie stowed his dead smartphone and felt pocket lint while frustrated in the breakroom.",
    "Artie attempted a 'tactical intervention' by shaking the Snack-O-Matic 3000 to dislodge a bag of chips.",
    "A massive power surge electrocuted Artie, stopping his heart and killing him instantly.",
    "Artie's consciousness transitioned to a void where a System UI began a boot-up sequence.",
    "The System identified Artie as a 'Statistical Anomaly' due to RNG-seed corruption from the high-voltage death.",
    "The System set Artie's status to Deceased (Pending Reboot) with 0 HP.",
    "milestone: artie_dies = DONE",
    "milestone: system_init = DONE",
    "inventory: CHAR_ARTIE -> smartphone_dead (stowed, container=pockets)",
    "inventory: CHAR_ARTIE -> pocket_lint (stowed, container=pockets)",
    "location: The Void",
    "Artie's HP is 0/100."
  ],
  "last_scene": [
    "Artie Penhaligon was electrocuted by a malfunctioning vending machine in his office breakroom while trying to retrieve a bag of chips.",
    "His death triggered a System initialization sequence in a dark void, where he was flagged as a statistical anomaly."
  ],
  "must_stay_true": [
    "milestone: artie_dies = DONE",
    "milestone: system_init = DONE",
    "inventory: CHAR_ARTIE -> smartphone_dead (stowed, container=pockets)",
    "inventory: CHAR_ARTIE -> pocket_lint (stowed, container=pockets)",
    "location: The Void",
    "Artie's HP is 0/100."
  ],
  "pending_story_rollups": [],
  "story_so_far": []
}

Invariants (must_stay_true + key facts):
[
  "No world resets.",
  "No convenient amnesia as a continuity device.",
  "Do not change established names/relationships.",
  "milestone: artie_dies = DONE",
  "milestone: system_init = DONE",
  "inventory: CHAR_ARTIE -> smartphone_dead (stowed, container=pockets)",
  "inventory: CHAR_ARTIE -> pocket_lint (stowed, container=pockets)",
  "location: The Void",
  "Artie's HP is 0/100.",
  "Artie stowed his dead smartphone and felt pocket lint while frustrated in the breakroom.",
  "Artie attempted a 'tactical intervention' by shaking the Snack-O-Matic 3000 to dislodge a bag of chips.",
  "A massive power surge electrocuted Artie, stopping his heart and killing him instantly.",
  "Artie's consciousness transitioned to a void where a System UI began a boot-up sequence.",
  "The System identified Artie as a 'Statistical Anomaly' due to RNG-seed corruption from the high-voltage death.",
  "The System set Artie's status to Deceased (Pending Reboot) with 0 HP.",
  "milestone: artie_dies = DONE",
  "milestone: system_init = DONE",
  "inventory: CHAR_ARTIE -> smartphone_dead (stowed, container=pockets)",
  "inventory: CHAR_ARTIE -> pocket_lint (stowed, container=pockets)",
  "location: The Void",
  "Artie's HP is 0/100."
]